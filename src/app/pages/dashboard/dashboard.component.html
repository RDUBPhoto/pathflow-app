<ion-header class="glass-header">
  <ion-toolbar>
    <ion-title>Dashboard</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding glass-bg">
  <ion-item>
    <ion-label position="stacked">Add lane</ion-label>
    <ion-input
      [ngModel]="newLane()"
      (ngModelChange)="newLane.set($event)"></ion-input>
  </ion-item>
  <div style="margin-top:8px;">
    <ion-button (click)="addLane()">Add</ion-button>
    <span style="margin-left:10px">{{ status() }}</span>
  </div>

  <div style="margin-top:16px" *ngIf="loading()"><ion-spinner></ion-spinner></div>

  <div cdkDropListGroup class="board">
    <div
      class="lane"
      cdkDropList
      [id]="lane.id"
      [cdkDropListData]="items()[lane.id]"
      [cdkDropListConnectedTo]="laneIds()"
      (cdkDropListDropped)="onCardsDrop($event, lane.id)"
      *ngFor="let lane of lanes(); trackBy: trackLane">

      <div class="lane-header">{{ lane.name }}</div>

      <div class="add-card">
        <ion-input
          placeholder="New card title"
          [ngModel]="(newCardTitle()[lane.id] || '')"
          (ngModelChange)="setNewCardTitle(lane.id, $event)"></ion-input>
        <ion-button size="small" (click)="addCard(lane.id)">Add</ion-button>
      </div>

      <div class="cards">
        <div class="card" *ngFor="let it of items()[lane.id]; trackBy: trackItem" cdkDrag>
          <div class="card-title">{{ it.title }}</div>
        </div>
      </div>
    </div>
  </div>
</ion-content>
